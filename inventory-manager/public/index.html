<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Website Inventory Dashboard</title>

    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
      :root{
        --blue:#0C2C7A; --blue-soft:#2C6DFF; --gold:#E6B652; --gold2:#B98A2F;
        --ink:#0E0E0E; --muted:#4B4A46;
        --card-radius:18px;
      }
      html,body{margin:0;padding:0;font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:radial-gradient(1200px 780px at 50% 8%, #ffffff 0%, #ffffff 55%, rgba(12,44,122,.08) 75%, rgba(12,44,122,.16) 100%);color:var(--ink);}
      .wrap{max-width:1240px;margin:0 auto;padding:clamp(16px,4vw,32px);}
      header{display:flex;flex-direction:column;gap:6px;margin-bottom:18px;}
      .title{font-family:"Playfair Display",ui-serif,Georgia,serif;font-size:clamp(24px,4vw,34px);color:var(--blue);}
      .subtitle{color:var(--muted);font-size:14px;max-width:640px;}
      .summary-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-bottom:18px;}
      .card{border-radius:var(--card-radius);background:#fff;border:1px solid rgba(12,44,122,.10);box-shadow:0 18px 50px rgba(12,44,122,.10);padding:12px 14px;}
      .card h3{margin:0;font-size:12px;text-transform:uppercase;letter-spacing:.08em;color:#77746c;}
      .card .value{margin-top:6px;font-size:20px;font-weight:700;color:var(--blue);}
      .card .meta{margin-top:4px;font-size:12px;color:#9a988f;}
      .charts-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-bottom:20px;}
      .chart-card{border-radius:var(--card-radius);background:#fff;border:1px solid rgba(12,44,122,.10);box-shadow:0 18px 50px rgba(12,44,122,.10);padding:10px 10px 4px;display:flex;flex-direction:column;}
      .chart-title{font-size:13px;font-weight:600;color:var(--blue);margin:0 4px 6px;}
      .chart{width:100%;height:240px;}
      .table-card{border-radius:var(--card-radius);background:#fff;border:1px solid rgba(12,44,122,.10);box-shadow:0 18px 50px rgba(12,44,122,.10);padding:12px 14px;margin-bottom:40px;display:flex;flex-direction:column;gap:10px;}
      .table-header{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;}
      .table-title{font-size:13px;font-weight:600;color:var(--blue);margin:0;}
      .table-meta{font-size:11px;color:#9a988f;}
      .search-input{min-width:220px;padding:8px 12px;border-radius:999px;border:1px solid rgba(12,44,122,.16);background:#fff;font-size:13px;box-shadow:0 10px 26px rgba(12,44,122,.08);outline:none;}
      .search-input::placeholder{color:#9a9a96;}
      .manage-toolbar{position:sticky;top:6px;z-index:3;display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:8px;border-radius:12px;background:#F8FAFF;border:1px solid #E6EAF6;}
      .toolbar-select{min-width:170px;padding:8px 10px;border-radius:999px;border:1px solid rgba(12,44,122,.16);background:#fff;font-size:13px;outline:none;}
      .toggle-wrap{display:inline-flex;gap:6px;align-items:center;font-size:12px;color:#555;}
      .save-pill{display:inline-flex;padding:4px 10px;border-radius:999px;font-size:11px;font-weight:600;}
      .save-pill.saved{background:rgba(0,128,96,.12);color:#0b6a4b;}
      .save-pill.saving{background:rgba(230,182,82,.2);color:#7a5a18;}
      .save-pill.error{background:rgba(203,63,63,.16);color:#9d1d1d;}
      .clear-btn{padding:7px 12px;border-radius:999px;border:1px solid rgba(12,44,122,.16);background:#fff;font-size:12px;cursor:pointer;}

      .table-scroll{border-radius:14px;border:1px solid #ECEEF7;overflow:auto;max-height:420px;}
      table{border-collapse:collapse;width:100%;font-size:12px;background:#fff;}
      thead{position:sticky;top:0;z-index:1;background:#F5F6FC;}
      th,td{padding:6px 8px;border-bottom:1px solid #ECEEF7;text-align:left;vertical-align:middle;}
      th{font-weight:600;color:#66635d;white-space:nowrap;}
      tbody tr.low{background:rgba(230,182,82,.08);} tbody tr.low td{border-bottom-color:rgba(230,182,82,.35);}
      .badge-low{display:inline-flex;padding:2px 8px;border-radius:999px;background:rgba(230,182,82,.16);color:#7a5a18;font-size:11px;margin-left:4px;}
      .pill-status{display:inline-flex;padding:2px 8px;border-radius:999px;font-size:11px;}
      .pill-status.active{background:rgba(0,128,96,.12);color:#0b6a4b;} .pill-status.inactive{background:rgba(153,153,153,.16);color:#555;}
      .footer-note{font-size:11px;color:#9a988f;} .pill-count{font-size:11px;background:#F5F6FC;border-radius:999px;padding:2px 8px;margin-left:4px;}
      .cell-main{display:flex;align-items:center;gap:8px;}
      .thumb-img{width:52px;height:52px;border-radius:10px;object-fit:cover;box-shadow:0 6px 16px rgba(12,44,122,.18);flex-shrink:0;}
      .img-placeholder{width:52px;height:52px;border-radius:10px;display:grid;place-items:center;background:radial-gradient(circle at 0 0, rgba(230,182,82,.3), rgba(12,44,122,.08));font-size:9px;color:#666;text-align:center;line-height:1.2;flex-shrink:0;}
      .item-main-text{display:flex;flex-direction:column;gap:2px;}
      .item-name{font-weight:600;color:var(--blue);}
      .img-btn{display:inline-flex;align-items:center;justify-content:center;padding:3px 9px;font-size:11px;border-radius:999px;border:1px solid rgba(12,44,122,.18);background:linear-gradient(#fff,#F4F7FF);cursor:pointer;max-width:max-content;}
      .img-btn:hover{box-shadow:0 6px 16px rgba(12,44,122,.16);transform:translateY(-1px);}
      .item-meta-inline{display:flex;align-items:center;gap:6px;}
      .type-badge{display:inline-flex;padding:2px 7px;border-radius:999px;font-size:10px;font-weight:600;}
      .type-badge.main{background:rgba(12,44,122,.12);color:#0c2c7a;}
      .type-badge.variant{background:rgba(230,182,82,.2);color:#7a5a18;}
      .editable-cell{display:flex;flex-direction:column;gap:2px;min-width:120px;}
      .editable-display{border:1px solid #dfe5f5;background:#fff;border-radius:8px;padding:4px 6px;font-size:12px;text-align:left;cursor:text;}
      .editable-cell.saving .editable-display{opacity:.7;}
      .editable-cell.error .editable-display{border-color:#c84040;background:#fff6f6;}
      .cell-input{border:1px solid #9bb0e9;background:#fff;border-radius:8px;padding:4px 6px;font-size:12px;outline:none;}
      .cell-state{font-size:10px;color:#9a988f;min-height:12px;}
      .retry-btn{max-width:max-content;border:none;background:none;color:#9d1d1d;font-size:10px;padding:0;cursor:pointer;text-decoration:underline;}
      .muted{color:#9a988f;}

    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="title">Website Inventory Overview</div>
        <div class="subtitle">
          Live snapshot of items assigned to the website. Use this to spot low stock,
          understand stock value, and prep for restocks before customers notice.
        </div>
      </header>

      <section class="summary-row">
        <article class="card"><h3>Total Website SKUs</h3><div class="value" id="totalItems">–</div><div class="meta">Active items listed for sale.</div></article>
        <article class="card"><h3>Total Stock Qty</h3><div class="value" id="totalStockQty">–</div><div class="meta">Units currently on hand.</div></article>
        <article class="card"><h3>Stock Value (JMD)</h3><div class="value" id="totalStockValue">–</div><div class="meta">Based on selling price × qty.</div></article>
        <article class="card"><h3>Low Stock Alerts</h3><div class="value" id="lowStockCount">–</div><div class="meta">Items at or below reorder level.</div></article>
      </section>

      <section class="charts-grid">
        <article class="chart-card"><h3 class="chart-title">Stock Status Breakdown</h3><div id="chartStatus" class="chart"></div></article>
        <article class="chart-card"><h3 class="chart-title">Top 10 Items by Quantity</h3><div id="chartTopQty" class="chart"></div></article>
        <article class="chart-card"><h3 class="chart-title">Top 10 Items by Stock Value (JMD)</h3><div id="chartTopValue" class="chart"></div></article>
        <article class="chart-card"><h3 class="chart-title">Reorder Risk – On Hand vs Reorder Level</h3><div id="chartReorder" class="chart"></div></article>
      </section>

      <section class="table-card">
        <div class="table-header">
          <div>
            <h3 class="table-title">Inventory Detail <span class="pill-count" id="visibleCount">0 items</span></h3>
            <div class="table-meta">Search by name or SKU, classify products inline, and manage variants directly from the table.</div>
          </div>
        </div>

        <div class="manage-toolbar">
          <input id="searchBox" class="search-input" placeholder="Search by item name or SKU…" />
          <select id="categoryFilter" class="toolbar-select">
            <option value="ALL">All categories</option>
          </select>
          <label class="toggle-wrap">
            <input id="showVariants" type="checkbox" />
            <span>Show variants</span>
          </label>
          <span id="saveStatus" class="save-pill saved">Saved</span>
          <button id="clearFiltersBtn" class="clear-btn" type="button">Clear filters</button>
        </div>

        <div class="table-scroll">
          <table id="itemsTable">
            <thead>
              <tr><th>Item & Image</th><th>SKU</th><th>On Hand</th><th>Reorder Level</th><th>Stock On Hand</th><th>Selling Price</th><th>Stock Value</th><th>Status</th><th>Unit</th><th>Ref ID</th><th>Category</th><th>ParentID</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="footer-note">Low stock rows are highlighted in gold. Data source: <strong>WebsiteItems</strong> sheet.</div>
      </section>
    </div>

    <input type="file" id="imagePicker" accept="image/*" style="display:none" />

    <script src="/app.js"></script>
  </body>
</html>
